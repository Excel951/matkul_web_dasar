<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			http-equiv="X-UA-Compatible"
			content="IE=edge" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0" />
		<link
			href="../../bootstrap-5.3.0-alpha3-dist/css/bootstrap.min.css"
			rel="stylesheet" />
		<script src="../../bootstrap-5.3.0-alpha3-dist/js/bootstrap.bundle.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
		<style>
			#navbarNavDropdown .navbar-nav .dropdown-item:hover {
				cursor: pointer;
			}
		</style>
		<title>Master Toko</title>
	</head>
	<body>
		<header>
			<div class="container text-center">
				<div class="row">
					<div class="columns"></div>
					<div class="columns">
						<h1 class="h1">Toko</h1>
					</div>
					<div class="columns"></div>
				</div>
			</div>
			<nav class="navbar navbar-expand-lg bg-body-tertiary">
				<div class="container-fluid">
					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarNavDropdown"
						aria-controls="navbarNavDropdown"
						aria-expanded="false"
						aria-label="Toggle navigation">
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="container text-center">
						<div class="row">
							<div class="columns"></div>
							<div
								class="collapse navbar-collapse columns"
								id="navbarNavDropdown">
								<ul class="navbar-nav">
									<li class="nav-item dropdown">
										<a
											class="nav-link dropdown-toggle"
											role="button"
											data-bs-toggle="dropdown"
											aria-expanded="false">
											Master
										</a>
										<ul class="dropdown-menu">
											<li>
												<a
													id="navBarang"
													class="dropdown-item"
													>Barang</a
												>
											</li>
											<li>
												<a
													id="navSupplier"
													class="dropdown-item"
													>Supplier</a
												>
											</li>
											<li>
												<a
													id="navKaryawan"
													class="dropdown-item"
													>Karyawan</a
												>
											</li>
										</ul>
									</li>
								</ul>
								<ul class="navbar-nav">
									<li class="nav-item dropdown">
										<a
											class="nav-link dropdown-toggle"
											href=""
											role="button"
											data-bs-toggle="dropdown"
											aria-expanded="false">
											Transaksi
										</a>
										<ul class="dropdown-menu">
											<li>
												<a
													id="navPenjualan"
													class="dropdown-item"
													>Penjualan</a
												>
											</li>
											<li>
												<a
													id="navPembelian"
													class="dropdown-item"
													>Pembelian</a
												>
											</li>
										</ul>
									</li>
								</ul>
								<ul class="navbar-nav">
									<li class="nav-item dropdown">
										<a
											class="nav-link dropdown-toggle"
											href=""
											role="button"
											data-bs-toggle="dropdown"
											aria-expanded="false">
											Laporan
										</a>
										<ul class="dropdown-menu">
											<li>
												<a
													id="navLabaRugi"
													class="dropdown-item"
													>Laba Rugi</a
												>
											</li>
											<li>
												<a
													id="navStok"
													class="dropdown-item"
													>Stok</a
												>
											</li>
										</ul>
									</li>
								</ul>
							</div>
							<div class="columns"></div>
						</div>
					</div>
				</div>
			</nav>
		</header>
		<main class="container-fluid"></main>

		<script>
			$(document).ready(function () {
				$.fn.pindahHalamanIndex = function () {
					$("header #navbarNavDropdown").click(function (event) {
						if (event.target.id === "navBarang") {
							$("main").load("./tugas1/tugas1.html span", function () {
								// ketika tambah barang
								$(document).on(
									"shown.bs.modal",
									"#staticBackdrop",
									function (event) {
										// ketika klik batal
										$("#dismissBtn").click(function () {
											elKode.val("");
											elNama.val("");
											elGol.val("null");
											elSat.val("");
											elHrg.val("");
										});

										// ketika klik save
										$("#btnSaveBarang").click(function () {
											// ambil value
											const kode = $("#kode").val();
											const nama = $("#nama").val();
											const gol = $("#gol").val();
											const satuan = $("#satuan").val();
											const hrg = $("#harga").val();

											console.log(kode, nama, gol, satuan, hrg);

											const table = document.querySelector("#mytable tbody");
											const row = table.insertRow(-1);
											const cellKode = row.insertCell(0);
											cellKode.appendChild(document.createTextNode(kode));
											const cellGol = row.insertCell(1);
											cellGol.appendChild(document.createTextNode(nama));
											const cellNama = row.insertCell(2);
											cellNama.appendChild(document.createTextNode(gol));
											const cellSat = row.insertCell(3);
											cellSat.appendChild(document.createTextNode(satuan));
											const cellHrg = row.insertCell(4);
											cellHrg.appendChild(document.createTextNode(hrg));
											const cellAction = row.insertCell(5);

											const btnUpdate = document.createElement("button");
											btnUpdate.setAttribute("type", "submit");
											btnUpdate.setAttribute("data-bs-toggle", "modal");
											btnUpdate.setAttribute(
												"data-bs-target",
												"#staticBackdrop"
											);
											btnUpdate.setAttribute("class", "btn btn-info update");
											btnUpdate.innerText = "U";
											cellAction.appendChild(btnUpdate);

											const btnRemove = document.createElement("button");
											btnRemove.setAttribute("type", "reset");
											btnRemove.setAttribute("data-bs-toggle", "modal");
											btnRemove.setAttribute(
												"data-bs-target",
												"#staticBackdrop"
											);
											btnRemove.setAttribute("class", "btn btn-danger remove");
											btnRemove.innerText = "X";
											cellAction.appendChild(btnRemove);

											$("#kode").val("");
											$("#nama").val("");
											$("#gol").val("null");
											$("#satuan").val("");
											$("#hrg").val("");
										});
									}
								);

								// Ketika klik tombol update
								$("#mytable").on("click", ".update", function () {
									// Ubah judul modal
									$("#staticBackdrop .modal-content .modal-header")
										.find("h1")
										.text("Update Barang");

									// cari tr
									const el = $(this).closest("tr");
									const elRowIndex = el.index();
									const elRow = el.find("td");

									// ambil semua value dari cell
									const kode = elRow[0].innerHTML;
									const gol = elRow[1].innerHTML;
									const nama = elRow[2].innerHTML;
									const sat = elRow[3].innerHTML;
									const hrg = elRow[4].innerHTML;

									// ambil modal
									const modal = $("span #staticBackdrop");

									// cari dan setting value dari form
									const elKode = modal.find("#kode");
									const elNama = modal.find("#nama");
									const elGol = modal.find("#gol");
									const elSat = modal.find("#satuan");
									const elHrg = modal.find("#harga");

									elKode.val(kode);
									elNama.val(nama);
									elGol.val(gol);
									elSat.val(sat);
									elHrg.val(hrg);

									$("span #staticBackdrop").on(
										"click",
										"#btnSaveBarang",
										function () {
											elRow[0].innerHTML = elKode.val();
											elRow[1].innerHTML = elGol.val();
											elRow[2].innerHTML = elNama.val();
											elRow[3].innerHTML = elSat.val();
											elRow[4].innerHTML = elHrg.val();

											elKode.val("");
											elNama.val("");
											elGol.val("null");
											elSat.val("");
											elHrg.val("");
										}
									);

									$("span #staticBackdrop").on(
										"click",
										"#dismissBtn",
										function () {
											elKode.val("");
											elNama.val("");
											elGol.val("null");
											elSat.val("");
											elHrg.val("");
										}
									);
								});
							});
						} else if (event.target.id === "navKaryawan") {
							$("main").load("./tugas2/tugas2.html span", function () {});
						} else if (event.target.id === "navSupplier") {
							$("main").load("./tugas3/tugas3.html span", function () {});
						} else if (event.target.id === "navPenjualan") {
							$("main").load("./tugas4/penjualan1.html span", function () {});
						} else if (event.target.id === "navPembelian") {
							$("main").load("./tugas5/pembelian.html span", function () {});
						}
					});
				};

				$.fn.pindahHalamanPembelian = function () {
					$("main").click(function (event) {
						if (event.target.id === "btnPlus") {
							$("#main").load("./tugas5/pembelian3.html", function () {
								$.fn.getJabatan();
								$.fn.getBarang();
								$.fn.removeBarang();
								$.fn.ambilWaktu();
								$("#save").click(function () {
									$.fn.saveBarang();
								});
								$.fn.getSupplier();
							});
						} else if (event.target.id === "btnRekap") {
							$("#main").load("./tugas5/pembelian1.html", function () {
								// hitung total barang
								$.fn.hitungTotal("pembelian1", 3);
								// hitung total harga
								$.fn.hitungTotal("pembelian1", 4);
							});
						} else if (event.target.id === "btnDetail") {
							$("#main").load("./tugas5/pembelian2.html", function () {
								// hitung total barang
								$.fn.hitungTotal("pembelian2", 1);
								// hitung total harga
								$.fn.hitungTotal("pembelian2", 2);
							});
						} else if (event.target.className === "view is-info") {
							$("#main").load("./tugas5/pembelian4.html", function () {
								$.fn.ambilWaktu();
								$.fn.getJabatan();
								$.fn.getSupplier();
							});
						}
					});
				};

				$.fn.pindahHalamanIndex();
			});
		</script>
	</body>
</html>
